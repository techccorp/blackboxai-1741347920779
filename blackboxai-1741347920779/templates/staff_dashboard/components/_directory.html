{% extends "directory_base.html" %}

{% block left_panel %}
<div class="flex flex-col min-h-screen p-4">
  <div class="flex justify-center mb-6">
    <img
      src="https://mylocalfoodie.b-cdn.net/white_logo.png"
      alt="Le Repertoire logo"
      width="150"
      height="50"
      class="mb-6"
    />
  </div>
  <div class="text-purple-600 font-semibold mb-4">Le Repertoire</div>
  <div class="mb-4">
    <button
      id="onboarding-button"
      class="text-gray-500 uppercase text-xs mb-2 hover:text-amber-600 transition"
    >
      Onboarding
    </button>
    <div class="text-gray-700 mb-2 option">New hire onboarding</div>
  </div>
  <div class="mb-4">
    <div class="text-gray-500 uppercase text-xs mb-2">Documents</div>
    <div class="text-gray-700 mb-2 option">Team documents</div>
  </div>
  <div class="mb-4">
    <div class="text-gray-500 uppercase text-xs mb-2">Hire</div>
    <div class="text-gray-700 mb-2 option">Applicants</div>
    <div class="text-gray-700 mb-2 option">Interviews</div>
    <div class="text-gray-700 mb-2 option">Job listings</div>
    <div class="text-gray-700 mb-2 option">Careers page</div>
    <div class="text-gray-700 mb-2 option">Settings</div>
  </div>
  <div class="mb-4">
    <div class="text-gray-500 uppercase text-xs mb-2">Culture</div>
    <div class="text-gray-700 mb-2 option">Team engagement</div>
  </div>
  <div class="mt-auto">
    <!-- Modal Structure -->
    <div
      id="onboarding-modal"
      class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center hidden"
    >
      <div class="bg-white p-6 rounded-lg shadow-lg w-1/3 relative">
        <!-- Close Button -->
        <button
          id="close-modal"
          class="absolute top-4 right-4 text-gray-500 hover:text-gray-700"
        >
          &times;
        </button>
        {% include "modals/onboarding_modal.html" %}
      </div>
    </div>
  </div>
</div>
{% endblock left_panel %}


{% block right_upper %}
<!-- Move the top navigation bar here -->
<div class="flex justify-between items-center mb-6">
  <!-- Left Tabs -->
  <div class="flex items-center space-x-4">
    <a class="text-gray-500 tab-option" href="{{ url_for('common.employee_profile') }}">Me</a>
    <a class="text-gray-500 tab-option" href="{{ url_for('common.news_feed') }}">News Feed</a>
    <a class="text-gray-500 tab-option" href="{{ url_for('common.google_feature_tasks') }}">Tasks</a>
    <a class="text-gray-500 tab-option" href="{{ url_for('common.locations') }}">Locations</a>
    <a class="text-gray-900 font-semibold tab-option active" href="{{ url_for('common.employee_people') }}">People</a>
    <a class="text-gray-500 tab-option" href="{{ url_for('common.employee_roster') }}">Schedule</a>
    <a class="text-gray-500 tab-option" href="{{ url_for('common.employee_timesheets') }}">Timesheets</a>
    <a class="text-gray-500 tab-option" href="{{ url_for('common.finance_payroll_reports') }}">Reports</a>
  </div>

  <!-- Right Controls -->
  <div class="flex items-center space-x-4">
    <div class="flex items-center space-x-2">
      <i class="fas fa-bell text-gray-500"></i>
      <div class="flex items-center space-x-2">
        <img
          class="rounded-full"
          src="https://storage.googleapis.com/a1aa/image/yRITEG6y864NHFW0g8iKM2LNmDcpEfqtgmW6ipQ0m6u6HL8JA.jpg"
          alt="User avatar"
          width="30"
          height="30"
        />
        <span class="text-gray-500">Hello, {'preffered_name'}</span>
      </div>
    </div>
    <button class="bg-transparent border border-amber-600 text-black px-4 py-2 rounded hover:bg-green-600 hover:border-transparent hover:text-white">
      Add People
    </button>
  </div>
</div>
{% endblock right_upper %}


{% block right_lower %}
<!-- Main content area -->
<div class="flex-grow">
  <div class="bg-white p-6 rounded-md shadow-md">
     <div class="flex flex-col md:flex-row items-center justify-between mb-4">
      <div class="flex items-center mb-4 md:mb-0">
       <input class="border border-gray-300 rounded-md p-2 mr-2" placeholder="Search" type="text"/>
       <button class="bg-purple-600 text-white px-4 py-2 rounded-md">
        Search
       </button>
      </div>
      <div class="flex items-center">
       <button class="bg-gray-200 text-gray-600 px-4 py-2 rounded-md mr-2">
        Filters (1)
       </button>
       <div class="relative">
        <button class="bg-gray-200 text-gray-600 px-4 py-2 rounded-md" onclick="toggleDropdown()">
         Display
        </button>
        <!-- Increased z-index so the dropdown appears on top -->
        <div 
          class="absolute right-0 mt-2 w-48 bg-white border border-gray-300 rounded-md shadow-md hidden" 
          id="dropdown" 
          style="z-index: 9999;"
        >
         <ul class="py-2">
          <li class="px-4 py-2 hover:bg-gray-100">
           <input checked class="mr-2" type="checkbox" data-colname="position"/>
           Position
          </li>
          <li class="px-4 py-2 hover:bg-gray-100">
           <input checked class="mr-2" type="checkbox" data-colname="venue"/>
           Venue
          </li>
          <li class="px-4 py-2 hover:bg-gray-100">
           <input checked class="mr-2" type="checkbox" data-colname="work-area"/>
           Work Area
          </li>
          <li class="px-4 py-2 hover:bg-gray-100">
           <input checked class="mr-2" type="checkbox" data-colname="status"/>
           Status
          </li>
          <li class="px-4 py-2 hover:bg-gray-100">
           <input checked class="mr-2" type="checkbox" data-colname="email"/>
           Email
          </li>
          <li class="px-4 py-2 hover:bg-gray-100">
           <input checked class="mr-2" type="checkbox" data-colname="contact"/>
           Contact
          </li>
          <li class="px-4 py-2 hover:bg-gray-100">
           <input checked class="mr-2" type="checkbox" data-colname="payrates"/>
           Payrates
          </li>
         </ul>
        </div>
       </div>
       <button class="bg-gray-200 text-gray-600 px-4 py-2 rounded-md ml-2">
        Bulk actions
       </button>
       <button class="bg-gray-200 text-gray-600 px-4 py-2 rounded-md ml-2">
        Clear
       </button>
      </div>
     </div>
     <table class="w-full text-left">
      <thead>
       <tr class="border-b">
        <th class="py-2 w-1/6">
         Name
        </th>
        <!-- Link each column header to the data-colname for toggling -->
        <th class="py-2 w-1/12" data-column-header="position">
         Position
        </th>
        <th class="py-2 w-1/12" data-column-header="venue">
         Venue
        </th>
        <th class="py-2 w-1/12" data-column-header="work-area">
         Work Area
        </th>
        <th class="py-2 w-1/12" data-column-header="status">
         Status
        </th>
        <th class="py-2 w-1/12" data-column-header="email">
         Email
        </th>
        <th class="py-2 w-1/12" data-column-header="contact">
         Contact
        </th>
        <th class="py-2 w-1/6" data-column-header="payrates">
         Pay Rates
        </th>
       </tr>
      </thead>
      <tbody>
       <tr class="border-b">
        <td class="py-2 flex items-center">
         <div class="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center mr-2">
          LD
         </div>
         <span>
          {'preffered_name'} {'last_name'}
         </span>
        </td>
        <td class="py-2" data-column="position">
         {'employee_role'}
        </td>
        <td class="py-2" data-column="venue">
         {'employee_venue_id'}
        </td>
        <td class="py-2" data-column="work-area">
         {'employee_work_area_id'}
        </td>
        <td class="py-2" data-column="status">
         {'status'}
        </td>
        <td class="py-2" data-column="email">
         <a class="text-blue-600" href="mailto:{'email'}">
          {'email'}
         </a>
        </td>
        <td class="py-2" data-column="contact">
         <a class="text-blue-600" href="tel:{'contact_number'}">
          {'contact_number'}
         </a>
        </td>
        <td class="py-2 relative" data-column="payrates">
         <button
           class="bg-gray-200 text-gray-600 px-4 py-2 rounded-md"
           onclick="togglePayRates('payRates1')"
         >
          Display {'preffered_name'} Pay rates
         </button>
         <div
           id="payRates1"
           class="absolute left-0 mt-2 w-48 bg-white border border-gray-300 rounded-md shadow-md hidden"
           style="z-index: 10;"  <!-- Lower z-index than dropdown -->
         >
          <div class="px-4 py-2">
           Weekday: {'pay_rates.weekday'}
          </div>
          <div class="px-4 py-2">
           Saturday: {'pay_rates.saturday'}
          </div>
          <div class="px-4 py-2">
           Sunday: {'pay_rates.sunday'}
          </div>
          <div class="px-4 py-2">
           Public Holiday: {'pay_rates.public_holiday'}
          </div>
         </div>
        </td>
       </tr>
      </tbody>
     </table>
    </div>
   </div>
  </div>
{% endblock right_lower %}


{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/Onboarding_modal.js') }}"></script>
<script src="{{ url_for('static', filename='js/business_directory.js') }}"></script>
<script>
  function toggleDropdown() {
    const dropdown = document.getElementById('dropdown');
    dropdown.classList.toggle('hidden');
  }

  function togglePayRates(id) {
    const payRates = document.getElementById(id);
    payRates.classList.toggle('hidden');
  }

  // Show/hide columns based on which checkboxes are checked
  function updateTableColumns() {
    const dropdown = document.getElementById('dropdown');
    const checkboxes = dropdown.querySelectorAll('input[type="checkbox"]');

    checkboxes.forEach(checkbox => {
      const colName = checkbox.dataset.colname; // e.g. "access", "position", etc.
      const headerCell = document.querySelector(`[data-column-header="${colName}"]`);
      const bodyCells = document.querySelectorAll(`[data-column="${colName}"]`);

      if (checkbox.checked) {
        if (headerCell) headerCell.style.display = 'table-cell';
        bodyCells.forEach(cell => (cell.style.display = 'table-cell'));
      } else {
        if (headerCell) headerCell.style.display = 'none';
        bodyCells.forEach(cell => (cell.style.display = 'none'));
      }
    });
  }

  document.addEventListener('DOMContentLoaded', () => {
    // Attach listener to each checkbox
    const dropdown = document.getElementById('dropdown');
    const checkboxes = dropdown.querySelectorAll('input[type="checkbox"]');
    checkboxes.forEach(checkbox => {
      checkbox.addEventListener('change', updateTableColumns);
    });

    // Run once on page load
    updateTableColumns();
  });
</script>

<style>
  .dropdown-content {
    display: none;
    position: absolute;
    background-color: white;
    min-width: 300px;
    box-shadow: 0px 8px 16px rgba(0,0,0,0.2);
    z-index: 1;
  }
  .dropdown-content.show {
    display: block;
  }
  .option:hover,
  .option:active {
    color: #D97706; /* text-amber-600 */
  }
  .tab-option.active {
    color: #D97706; /* text-amber-600 */
  }
  .tab-option:hover,
  .tab-option:active {
    font-weight: 600; /* font-semibold */
    color: #D97706;  /* text-amber-600 */
    text-decoration: underline;
    text-underline-offset: 4px;
    text-decoration-color: #D97706; /* decoration-amber-600 */
  }
</style>
{% endblock extra_scripts %}
